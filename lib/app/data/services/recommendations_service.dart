import 'package:get/get.dart';
import 'package:marinette/app/data/services/face_shape_analyzer.dart';
import 'package:marinette/app/data/services/color_type_analyzer.dart';

class RecommendationsService {
  static List<String> getMakeupRecommendations(
      FaceShape shape, ColorType colorType) {
    List<String> recommendations = [];

    // Базові рекомендації по формі обличчя
    recommendations.addAll(_getMakeupShapeRecommendations(shape));

    // Додаємо рекомендації по кольоротипу
    recommendations.addAll(_getMakeupColorRecommendations(colorType));

    return recommendations;
  }

  static List<String> _getMakeupShapeRecommendations(FaceShape shape) {
    switch (shape) {
      case FaceShape.oval:
        return [
          'Підкресліть природні пропорції легким контурингом',
          'Рум\'яна наносіть по діагоналі вгору для додаткового ліфтингу',
          'Експериментуйте з різними техніками - ваша форма обличчя універсальна',
          'Акцентуйте увагу на очах або губах за вашим вибором',
          'Використовуйте хайлайтер на вилицях для підкреслення природного рельєфу'
        ];

      case FaceShape.round:
        return [
          'Використовуйте контуринг по бокам обличчя для видовження',
          'Наносьте рум\'яна під кутом догори для витягування форми',
          'Створюйте чіткі кути при нанесенні тонального засобу в зоні щелепи',
          'Робіть акцент на вилицях за допомогою хайлайтера',
          'Використовуйте техніку овального контурингу носа'
        ];

      case FaceShape.square:
        return [
          'Пом\'якшуйте кути обличчя за допомогою розтушованого контурингу',
          'Наносьте рум\'яна круговими рухами для пом\'якшення рис',
          'Уникайте різких ліній при нанесенні макіяжу',
          'Додавайте світловідбиваючі частинки в зоні скул',
          'Використовуйте м\'які пастельні тони для очей'
        ];

      case FaceShape.heart:
        return [
          'Підкресліть вилиці, щоб збалансувати ширше чоло',
          'Використовуйте хайлайтер на підборідді для візуального подовження',
          'Затемнюйте зовнішні кути чола для балансу',
          'Наносіть рум\'яна ближче до центру щік',
          'Акцентуйте нижню частину обличчя за допомогою світлих відтінків'
        ];

      case FaceShape.diamond:
        return [
          'Концентруйте контуринг на скронях та підборідді',
          'Наносьте рум\'яна горизонтально для пом\'якшення гострих кутів',
          'Підкреслюйте центр обличчя світлими відтінками',
          'Використовуйте м\'які переходи при розтушовці',
          'Додавайте об\'єм в нижній частині обличчя світлими текстурами'
        ];

      case FaceShape.rectangle:
        return [
          'Створюйте м\'які переходи при контурингу',
          'Використовуйте рум\'яна для додання округлості',
          'Підкресліть вилиці для балансу пропорцій',
          'Додавайте світлі акценти в центральній частині обличчя',
          'Уникайте вертикальних ліній при нанесенні макіяжу'
        ];
    }
  }

  static List<String> _getMakeupColorRecommendations(ColorType type) {
    switch (type) {
      case ColorType.spring:
        return [
          'Обирайте теплі, яскраві відтінки помади: корал, персик, теплий рожевий',
          'Використовуйте золотисті та персикові рум\'яна',
          'Для очей підійдуть бронзові, золотисті та теплі коричневі тіні',
          'Експериментуйте з теракотовими відтінками для губ',
          'Використовуйте теплі відтінки бронзера'
        ];

      case ColorType.summer:
        return [
          'Обирайте холодні, приглушені відтінки помади: рожевий, малиновий',
          'Використовуйте холодні рожеві та лавандові рум\'яна',
          'Для очей ідеальні сріблясті, сірі та прохолодні коричневі тони',
          'Уникайте занадто яскравих та теплих відтінків',
          'Віддавайте перевагу пастельним тонам'
        ];

      case ColorType.autumn:
        return [
          'Обирайте теплі, землисті відтінки помади: теракот, мідь',
          'Використовуйте теплі коричневі та теракотові рум\'яна',
          'Для очей підійдуть зелені, золотисто-коричневі тони',
          'Експериментуйте з насиченими осінніми кольорами',
          'Додавайте золотистий шиммер для сяяння'
        ];

      case ColorType.winter:
        return [
          'Обирайте яскраві, контрастні відтінки помади: червоний, фуксія',
          'Використовуйте холодні рожеві та ягідні рум\'яна',
          'Для очей підійдуть димчасті, сині та сріблясті відтінки',
          'Експериментуйте з насиченими кольорами',
          'Використовуйте контрастні комбінації'
        ];
    }
  }

  static List<String> getHairstyleRecommendations(
      FaceShape shape, ColorType colorType) {
    List<String> recommendations = [];

    // Базові рекомендації по формі обличчя
    recommendations.addAll(_getHairstyleShapeRecommendations(shape));

    // Додаємо рекомендації по кольору волосся
    recommendations.addAll(_getHairColorRecommendations(colorType));

    return recommendations;
  }

  static List<String> _getHairstyleShapeRecommendations(FaceShape shape) {
    switch (shape) {
      case FaceShape.oval:
        return [
          'Вам підходить більшість зачісок завдяки пропорційній формі обличчя',
          'Спробуйте довге волосся з легкими хвилями для романтичного образу',
          'Середня довжина з градуюванням підкреслить риси обличчя',
          'Можна експериментувати з чубчиком будь-якої форми',
          'Підійдуть як прямі, так і кучеряві зачіски'
        ];

      case FaceShape.round:
        return [
          'Обирайте зачіски, що додають висоти та видовжують обличчя',
          'Уникайте занадто об\'ємних укладок з боків',
          'Асиметричні стрижки допоможуть видовжити обличчя',
          'Довге волосся з рваними кінцями створить потрібний ефект',
          'Косий чубчик допоможе зробити обличчя більш витонченим'
        ];

      case FaceShape.square:
        return [
          'Обирайте м\'які, хвилясті укладки для пом\'якшення рис',
          'Уникайте прямого волосся з чіткими лініями',
          'Багатошарові стрижки додадуть м\'якості',
          'Довжина нижче підборіддя пом\'якшить лінію щелепи',
          'Легкі локони біля обличчя створять романтичний образ'
        ];

      case FaceShape.heart:
        return [
          'Обирайте зачіски з об\'ємом внизу для балансу',
          'Уникайте занадто об\'ємних укладок у верхній частині',
          'Середня довжина з м\'якими шарами ідеально підійде',
          'Бокові проділи допоможуть збалансувати риси',
          'Довгий боковий чубчик пом\'якшить лінію чола'
        ];

      case FaceShape.diamond:
        return [
          'Обирайте зачіски з об\'ємом у скроневій зоні',
          'Експериментуйте з шаруватими стрижками',
          'Довжина до плечей або нижче найбільш вдала',
          'Уникайте занадто прилеглих до голови зачісок',
          'М\'які хвилі середньої довжини підкреслять вашу форму обличчя'
        ];

      case FaceShape.rectangle:
        return [
          'Обирайте багатошарові стрижки для додання об\'єму',
          'Додайте об\'єму з боків для балансу пропорцій',
          'Уникайте занадто довгого прямого волосся',
          'Чубчик допоможе візуально скоротити довжину обличчя',
          'Каскадні стрижки створять потрібний об\'єм'
        ];
    }
  }

  static List<String> _getHairColorRecommendations(ColorType type) {
    switch (type) {
      case ColorType.spring:
        return [
          'Золотисті відтінки блонду підкреслять природну яскравість',
          'Медові та карамельні тони чудово підійдуть',
          'Експериментуйте з теплими рудими відтінками',
          'Уникайте холодних попелястих тонів',
          'Спробуйте техніку медового балаяжу'
        ];

      case ColorType.summer:
        return [
          'Обирайте холодні платинові та попелясті відтінки',
          'Перлинний блонд підкреслить вашу зовнішність',
          'Експериментуйте з пастельними тонами',
          'Уникайте занадто теплих та рудих відтінків',
          'Підійдуть світло-русі тони з холодним підтоном'
        ];

      case ColorType.autumn:
        return [
          'Обирайте насичені каштанові та мідні відтінки',
          'Золотисто-коричневі тони підкреслять природну красу',
          'Експериментуйте з теплими рудими тонами',
          'Підійдуть відтінки кориці та карамелі',
          'Спробуйте техніку червоного балаяжу'
        ];

      case ColorType.winter:
        return [
          'Обирайте контрастні кольори - чорний або платиновий блонд',
          'Холодні темні відтінки підкреслять вашу зовнішність',
          'Експериментуйте з попелястими тонами',
          'Уникайте теплих медових відтінків',
          'Підійдуть синювато-чорні тони'
        ];
    }
  }

  static List<String> getSkincareRecommendations(ColorType colorType) {
    List<String> baseRecommendations = [
      'Обов\'язково використовуйте сонцезахисний крем щодня',
      'Очищайте шкіру двічі на день м\'яким засобом',
      'Не забувайте про зволоження шкіри',
      'Регулярно робіть пілінг та відлущування',
      'Використовуйте сироватки з активними компонентами'
    ];

    List<String> colorTypeRecommendations =
        _getSkincareColorRecommendations(colorType);

    return [...baseRecommendations, ...colorTypeRecommendations];
  }

  static List<String> _getSkincareColorRecommendations(ColorType type) {
    switch (type) {
      case ColorType.spring:
        return [
          'Використовуйте легкі текстури засобів',
          'Зверніть увагу на засоби з вітаміном С',
          'Додайте до догляду антиоксиданти',
          'Захищайтесь від пігментації SPF 30-50',
          'Обирайте заспокійливі маски для чутливої шкіри'
        ];

      case ColorType.summer:
        return [
          'Використовуйте некомедогенні засоби',
          'Зволожуйте шкіру легкими гелевими текстурами',
          'Захищайтесь від сонця SPF 50+',
          'Додайте до догляду ніацинамід',
          'Регулярно робіть заспокійливі маски'
        ];

      case ColorType.autumn:
        return [
          'Обирайте поживні креми з багатою текстурою',
          'Використовуйте олії для додаткового живлення',
          'Захищайтесь від сонця SPF 30+',
          'Звертайте увагу на засоби з ретинолом',
          'Регулярно використовуйте зволожуючі маски'
        ];

      case ColorType.winter:
        return [
          'Використовуйте креми з насиченою текстурою',
          'Додайте до догляду пептиди та церамиди',
          'Захищайтесь від сонця SPF 50+',
          'Зверніть увагу на засоби з гіалуроновою кислотою',
          'Робіть регулярно поживні маски'
        ];
    }
  }

  static String getSeasonalRecommendation() {
    final now = DateTime.now();
    final month = now.month;

    // Зима (грудень, січень, лютий)
    if (month == 12 || month == 1 || month == 2) {
      return 'season_winter'.tr;
    }
    // Весна (березень, квітень, травень)
    else if (month >= 3 && month <= 5) {
      return 'season_spring'.tr;
    }
    // Літо (червень, липень, серпень)
    else if (month >= 6 && month <= 8) {
      return 'season_summer'.tr;
    }
    // Осінь (вересень, жовтень, листопад)
    else {
      return 'season_autumn'.tr;
    }
  }

  static List<String> getPersonalizedTips({
    required FaceShape faceShape,
    required ColorType colorType,
    bool includeProductSuggestions = true,
  }) {
    List<String> tips = [];

    // Додаємо специфічні поради щодо макіяжу
    tips.add(_getPersonalizedMakeupTip(faceShape, colorType));

    // Додаємо пораду щодо догляду за волоссям
    tips.add(_getPersonalizedHairTip(faceShape));

    // Додаємо сезонну пораду
    tips.add(getSeasonalRecommendation());

    // Додаємо пропозиції щодо продуктів, якщо потрібно
    if (includeProductSuggestions) {
      tips.addAll(_getProductSuggestions(colorType));
    }

    return tips;
  }

  static String _getPersonalizedMakeupTip(
      FaceShape faceShape, ColorType colorType) {
    String base = 'Для вашого типу зовнішності особливо важливо: ';

    switch (faceShape) {
      case FaceShape.oval:
        base += 'підкреслювати природну гармонію рис обличчя. ';
        break;
      case FaceShape.round:
        base += 'створювати візуальні вертикальні лінії. ';
        break;
      case FaceShape.square:
        base += 'пом\'якшувати кути обличчя. ';
        break;
      case FaceShape.heart:
        base += 'балансувати верхню та нижню частини обличчя. ';
        break;
      case FaceShape.diamond:
        base += 'акцентувати увагу на центрі обличчя. ';
        break;
      case FaceShape.rectangle:
        base += 'створювати гармонійні пропорції. ';
        break;
    }

    switch (colorType) {
      case ColorType.spring:
        base +=
            'Використовуйте теплі, яскраві відтінки для створення свіжого образу.';
        break;
      case ColorType.summer:
        base += 'Обирайте ніжні, пастельні тони для природного макіяжу.';
        break;
      case ColorType.autumn:
        base +=
            'Віддавайте перевагу теплим, землистим відтінкам для гармонійного образу.';
        break;
      case ColorType.winter:
        base +=
            'Експериментуйте з яскравими, контрастними кольорами для виразного макіяжу.';
        break;
    }

    return base;
  }

  static String _getPersonalizedHairTip(FaceShape faceShape) {
    switch (faceShape) {
      case FaceShape.oval:
        return 'Ваша форма обличчя дозволяє експериментувати з різними зачісками. Спробуйте нові стилі укладки для різноманітності образів.';
      case FaceShape.round:
        return 'Оберіть зачіску з об\'ємом у верхній частині голови та видовженими пасмами для витонченого силуету.';
      case FaceShape.square:
        return 'М\'які хвилі та багатошарові стрижки допоможуть пом\'якшити риси обличчя.';
      case FaceShape.heart:
        return 'Зачіски з об\'ємом у нижній частині обличчя допоможуть збалансувати пропорції.';
      case FaceShape.diamond:
        return 'Додайте об\'єм у зоні скронь за допомогою бокових пасом або легких хвиль.';
      case FaceShape.rectangle:
        return 'Багатошарові стрижки середньої довжини допоможуть створити гармонійний образ.';
    }
  }

  static List<String> _getProductSuggestions(ColorType colorType) {
    List<String> suggestions = [
      'Рекомендовані продукти для вашого типу зовнішності:'
    ];

    switch (colorType) {
      case ColorType.spring:
        suggestions.addAll([
          '• BB-крем з легкою текстурою та сяючим фінішем',
          '• Персиковий або кораловий рум\'янець',
          '• Золотистий хайлайтер',
          '• Зволожуюча помада теплих відтінків'
        ]);
        break;
      case ColorType.summer:
        suggestions.addAll([
          '• Тональний крем з натуральним покриттям',
          '• Холодний рожевий рум\'янець',
          '• Перламутровий хайлайтер',
          '• Помада холодних рожевих відтінків'
        ]);
        break;
      case ColorType.autumn:
        suggestions.addAll([
          '• Тональна основа з матовим фінішем',
          '• Теракотовий або бронзовий рум\'янець',
          '• Бронзер теплих відтінків',
          '• Помада коричнево-червоних тонів'
        ]);
        break;
      case ColorType.winter:
        suggestions.addAll([
          '• Тональний крем з середнім покриттям',
          '• Яскраво-рожевий рум\'янець',
          '• Сріблястий хайлайтер',
          '• Помада насичених відтінків'
        ]);
        break;
    }

    return suggestions;
  }
}
